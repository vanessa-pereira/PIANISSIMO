{"name":"getMedicationList","category":"view","description":"Get last all medications registered for the patient by desc order of commit to ehr","metaData":"{\r\n    \"parameters\": [\r\n        {\r\n            \"name\": \"ehrId\",\r\n            \"description\": \"Ehr id\",\r\n            \"type\": \"string\"\r\n        }\r\n    ]\r\n}","steps":[{"processorName":"jsonFtlAql","processorData":"-- openEHR Template required: \"CLINNOVA IBD eCRF - Medications and treatments\" v0.1.22\r\n-- Authors: Vanessa Pereira (vanessa.pereira@lih.lu)\r\n\r\nSELECT \r\nt/activities[at0001]/description[at0002]/items[at0070]/value/value AS medicationItem,\r\nt/activities[at0001]/description[at0002]/items[at0070]/value/defining_code/code_string AS medicationItemCode,\r\nt/activities[at0001]/description[at0002]/items[at0070]/value/defining_code/terminology_id/value AS medicationItemOntology,\r\nc/archetype_details/template_id/value as templateID,\r\nc/uid/value as templateUid,\r\nc/context/start_time/value as compositionSubmitted,\r\nc/composer/name as creator,\r\nv/commit_audit/time_committed/value as created\r\nFROM EHR e\r\nCONTAINS VERSIONED_OBJECT vo\r\nCONTAINS VERSION v\r\nCONTAINS COMPOSITION c[openEHR-EHR-COMPOSITION.medication_list.v1] \r\nCONTAINS INSTRUCTION t[openEHR-EHR-INSTRUCTION.medication_order.v3]\r\nWHERE e/ehr_id/value = :ehrId\r\nORDER BY created DESC"}]}